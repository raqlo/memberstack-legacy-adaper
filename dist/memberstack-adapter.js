var __defProp=Object.defineProperty,__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__publicField=(e,t,r)=>__defNormalProp(e,"symbol"!=typeof t?t+"":t,r);!function(){"use strict";const e="ms2_enabled";const t=window.memberstackConfig||{},r=(o={adapter:{enabled:!0,importedMemberships:{},loginUrl:void 0,forcedVersion:"v2"},appIdV1:void 0,publicKey:void 0,appId:void 0,debug:!0,logLevel:"warn"},n=t,{...o,...n,adapter:{...o.adapter,...n.adapter}});var o,n;const a={fatal:0,error:0,warn:1,log:2,info:3,success:3,fail:3,debug:4,trace:5,verbose:Number.POSITIVE_INFINITY},s={silent:{level:-1},fatal:{level:a.fatal},error:{level:a.error},warn:{level:a.warn},log:{level:a.log},info:{level:a.info},success:{level:a.success},fail:{level:a.fail},ready:{level:a.info},start:{level:a.info},box:{level:a.info},debug:{level:a.debug},trace:{level:a.trace},verbose:{level:a.verbose}};function i(e){if(null===e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&(!(Symbol.iterator in e)&&(!(Symbol.toStringTag in e)||"[object Module]"===Object.prototype.toString.call(e)))}function l(e,t,r=".",o){if(!i(t))return l(e,{},r);const n=Object.assign({},t);for(const a in e){if("__proto__"===a||"constructor"===a)continue;const t=e[a];null!=t&&(Array.isArray(t)&&Array.isArray(n[a])?n[a]=[...t,...n[a]]:i(t)&&i(n[a])?n[a]=l(t,n[a],(r?`${r}.`:"")+a.toString()):n[a]=t)}return n}const d=(...e)=>e.reduce((e,t)=>l(e,t,""),{});function p(e){return t=e,"[object Object]"===Object.prototype.toString.call(t)&&(!(!e.message&&!e.args)&&!e.stack);var t}let u=!1;const c=[];class m{constructor(e={}){__publicField(this,"options"),__publicField(this,"_lastLog"),__publicField(this,"_mockFn");const t=e.types||s;this.options=d({...e,defaults:{...e.defaults},level:g(e.level,t),reporters:[...e.reporters||[]]},{types:s,throttle:1e3,throttleMin:5,formatOptions:{date:!0,colors:!1,compact:!0}});for(const r in t){const e={type:r,...this.options.defaults,...t[r]};this[r]=this._wrapLogFn(e),this[r].raw=this._wrapLogFn(e,!0)}this.options.mockFn&&this.mockTypes(),this._lastLog={}}get level(){return this.options.level}set level(e){this.options.level=g(e,this.options.types,this.options.level)}prompt(e,t){if(!this.options.prompt)throw new Error("prompt is not supported!");return this.options.prompt(e,t)}create(e){const t=new m({...this.options,...e});return this._mockFn&&t.mockTypes(this._mockFn),t}withDefaults(e){return this.create({...this.options,defaults:{...this.options.defaults,...e}})}withTag(e){return this.withDefaults({tag:this.options.defaults.tag?this.options.defaults.tag+":"+e:e})}addReporter(e){return this.options.reporters.push(e),this}removeReporter(e){if(e){const t=this.options.reporters.indexOf(e);if(-1!==t)return this.options.reporters.splice(t,1)}else this.options.reporters.splice(0);return this}setReporters(e){return this.options.reporters=Array.isArray(e)?e:[e],this}wrapAll(){this.wrapConsole(),this.wrapStd()}restoreAll(){this.restoreConsole(),this.restoreStd()}wrapConsole(){for(const e in this.options.types)console["__"+e]||(console["__"+e]=console[e]),console[e]=this[e].raw}restoreConsole(){for(const e in this.options.types)console["__"+e]&&(console[e]=console["__"+e],delete console["__"+e])}wrapStd(){this._wrapStream(this.options.stdout,"log"),this._wrapStream(this.options.stderr,"log")}_wrapStream(e,t){e&&(e.__write||(e.__write=e.write),e.write=e=>{this[t].raw(String(e).trim())})}restoreStd(){this._restoreStream(this.options.stdout),this._restoreStream(this.options.stderr)}_restoreStream(e){e&&e.__write&&(e.write=e.__write,delete e.__write)}pauseLogs(){u=!0}resumeLogs(){u=!1;const e=c.splice(0);for(const t of e)t[0]._logFn(t[1],t[2])}mockTypes(e){const t=e||this.options.mockFn;if(this._mockFn=t,"function"==typeof t)for(const r in this.options.types)this[r]=t(r,this.options.types[r])||this[r],this[r].raw=this[r]}_wrapLogFn(e,t){return(...r)=>{if(!u)return this._logFn(e,r,t);c.push([this,e,r,t])}}_logFn(e,t,r){if((e.level||0)>this.level)return!1;const o={date:new Date,args:[],...e,level:g(e.level,this.options.types)};!r&&1===t.length&&p(t[0])?Object.assign(o,t[0]):o.args=[...t],o.message&&(o.args.unshift(o.message),delete o.message),o.additional&&(Array.isArray(o.additional)||(o.additional=o.additional.split("\n")),o.args.push("\n"+o.additional.join("\n")),delete o.additional),o.type="string"==typeof o.type?o.type.toLowerCase():"log",o.tag="string"==typeof o.tag?o.tag:"";const n=(e=!1)=>{const t=(this._lastLog.count||0)-this.options.throttleMin;if(this._lastLog.object&&t>0){const e=[...this._lastLog.object.args];t>1&&e.push(`(repeated ${t} times)`),this._log({...this._lastLog.object,args:e}),this._lastLog.count=1}e&&(this._lastLog.object=o,this._log(o))};clearTimeout(this._lastLog.timeout);const a=this._lastLog.time&&o.date?o.date.getTime()-this._lastLog.time.getTime():0;if(this._lastLog.time=o.date,a<this.options.throttle)try{const e=JSON.stringify([o.type,o.tag,o.args]),t=this._lastLog.serialized===e;if(this._lastLog.serialized=e,t&&(this._lastLog.count=(this._lastLog.count||0)+1,this._lastLog.count>this.options.throttleMin))return void(this._lastLog.timeout=setTimeout(n,this.options.throttle))}catch{}n(!0)}_log(e){for(const t of this.options.reporters)t.log(e,{options:this.options})}}function g(e,t={},r=3){return void 0===e?r:"number"==typeof e?e:t[e]&&void 0!==t[e].level?t[e].level:r}m.prototype.add=m.prototype.addReporter,m.prototype.remove=m.prototype.removeReporter,m.prototype.clear=m.prototype.removeReporter,m.prototype.withScope=m.prototype.withTag,m.prototype.mock=m.prototype.mockTypes,m.prototype.pause=m.prototype.pauseLogs,m.prototype.resume=m.prototype.resumeLogs;class h{constructor(e){__publicField(this,"options"),__publicField(this,"defaultColor"),__publicField(this,"levelColorMap"),__publicField(this,"typeColorMap"),this.options={...e},this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c0392b",1:"#f39c12",3:"#00BCD4"},this.typeColorMap={success:"#2ecc71"}}_getLogFn(e){return e<1?console.__error||console.error:1===e?console.__warn||console.warn:console.__log||console.log}log(e){const t=this._getLogFn(e.level),r="log"===e.type?"":e.type,o=e.tag||"",n=`\n      background: ${this.typeColorMap[e.type]||this.levelColorMap[e.level]||this.defaultColor};\n      border-radius: 0.5em;\n      color: white;\n      font-weight: bold;\n      padding: 2px 0.5em;\n    `,a=`%c${[o,r].filter(Boolean).join(":")}`;"string"==typeof e.args[0]?t(`${a}%c ${e.args[0]}`,n,"",...e.args.slice(1)):t(a,n,...e.args)}}const b=function(e={}){return function(e={}){return new m(e)}({reporters:e.reporters||[new h({})],prompt:(e,t={})=>"confirm"===t.type?Promise.resolve(confirm(e)):Promise.resolve(prompt(e)),...e})}(),f={silent:0,fatal:0,error:1,warn:2,info:3,debug:4,trace:5,verbose:5};function w(e,t,...o){const n=r.logLevel||"info";b.level=f[n],(r.debug||function(e,t){const r=f[e];return r<=f[t]}(e,n))&&b[e](t,...o)}const A="adapter";function y(){return null!==localStorage.getItem("_ms-mid")}function v(){return y()?JSON.parse(localStorage.getItem("_ms-mem")):null}let _;async function $(){return _||(await new Promise(e=>{!function(e){var t;const r=v();e({email:(null==(t=null==r?void 0:r.auth)?void 0:t.email)||"",loggedIn:y(),getMetaData:async()=>r?(await window.$memberstackDom.getCurrentMember()).data.metaData||{}:(w("error","[Adapter] getMetaData() called while member is not authenticated. Returning empty object."),{}),updateMetaData(e){var t;if(r)return null==(t=window.$memberstackDom)?void 0:t.updateMemberJSON({json:e});w("error","[Adapter] updateMetaData() called while member is not authenticated. Returning empty object.")},updateProfile(e){var t;if(r)return null==(t=window.$memberstackDom)?void 0:t.updateMember({customFields:e});w("error","[Adapter] updateProfile() called while member is not authenticated. Returning empty object.")},memberPage:void 0,membership:null})}(t=>{_=t,window.MemberStack.__resolveOnReady&&(window.MemberStack.__resolveOnReady(_),delete window.MemberStack.__resolveOnReady),e(t)})}),_)}function S(e){const t=function(e){const t=(r=e,{reload:()=>{},logout:async()=>{await r.logout()},getToken:()=>r.getMemberCookie(),selectMembership:()=>{}});var r;return{onReady:$(),getToken:t.getToken,reload:t.reload,logout:t.logout,selectMembership:t.selectMembership}}(e);return Object.assign(window.MemberStack,t),new Proxy(window.MemberStack,{get(e,r){if(w("warn",`[Adapter] Proxying "${String(r)}" method...`),r in t)return t[r];w("error",`[Adapter] Method "${String(r)}" not found in adapter.`)}})}function k(e){return w("debug",`[Adapter] Getting plan attribute for ID: ${e}`),e.startsWith("prc_")?(w("debug",`[Adapter] ID "${e}" is a price ID, returning data-ms-plan:price`),"data-ms-plan:price"):e.startsWith("pln_")?(w("debug",`[Adapter] ID "${e}" is a plan ID, returning data-ms-plan:add`),"data-ms-plan:add"):(w("error",`[Adapter] Unknown ID format: "${e}" - expected prc_ or pln_ prefix`),null)}function L(e){w("debug","[Adapter] Processing data-ms-plan attributes");const t=document.querySelectorAll("[data-ms-plan]");return t.length&&(w("warn",`[Adapter] Found ${t.length} elements with data-ms-plan attribute`),t.forEach(t=>{const r=t.getAttribute("data-ms-plan");r&&function(e,t,r){w("debug",`[Adapter] Replacing plan attribute for old ID: ${t}`);const o=r[t];if(!o)return void w("error",`[Adapter] Plan ID "${t}" not found in importedMemberships mapping`);const n=k(o);n?(e.removeAttribute("data-ms-plan"),e.setAttribute(n,o),w("debug",`[Adapter] Successfully replaced plan attribute: ${t} -> ${o} (${n})`)):w("error",`[Adapter] Invalid new plan ID format "${o}" for old ID "${t}"`)}(t,r,e)})),t.length}function I(e){w("debug","[Adapter] Processing data-ms-membership attributes");const t=document.querySelectorAll("[data-ms-membership]");return t.length&&(w("warn",`[Adapter] Found ${t.length} elements with data-ms-membership attribute`),t.forEach(t=>{const r=t.getAttribute("data-ms-membership");r&&function(e,t,r){w("debug",`[Adapter] Replacing membership attribute for old ID: ${t}`);const o=r[t];if(!o)return void w("error",`[Adapter] Membership ID "${t}" not found in importedMemberships mapping`);const n=k(o);n?(e.removeAttribute("data-ms-membership"),e.setAttribute(n,o),"a"===e.tagName.toLowerCase()&&"#"===e.getAttribute("href")&&(e.setAttribute("data-ms-modal","signup"),w("debug",'[Adapter] Added data-ms-modal="signup" to link element')),w("debug",`[Adapter] Successfully replaced membership attribute: ${t} -> ${o} (${n})`)):w("error",`[Adapter] Invalid new membership ID format "${o}" for old ID "${t}"`)}(t,r,e)})),t.length}function M(e){w("debug","[Adapter] Processing hash-only signup URLs");const t=document.querySelectorAll('a[href^="#/ms/signup/"]');return t.length>0&&(w("warn",`[Adapter] Found ${t.length} elements with hash-only signup href attributes that will be converted to modal`),t.forEach(t=>{const r=t.getAttribute("href");if(r){const o=r.match(/#\/ms\/signup\/(.+)$/);if(o&&o[1]){!function(e,t,r){w("debug",`[Adapter] Replacing signup href for extracted ID: ${t}`);const o=r[t];if(!o)return void w("error",`[Adapter] Signup href ID "${t}" not found in importedMemberships mapping`);const n=k(o);n?(e.setAttribute("href","#"),e.setAttribute("data-ms-modal","signup"),e.setAttribute(n,o),w("debug",`[Adapter] Successfully replaced signup href: ${t} -> ${o} with modal and ${n}`)):w("error",`[Adapter] Invalid new signup ID format "${o}" for old ID "${t}"`)}(t,o[1],e)}else w("error",`[Adapter] Failed to extract ID from href: ${r}`)}})),t.length}function D(){w("debug","[Adapter] Processing hash-only login URLs");const e=document.querySelectorAll('a[href="#/ms/login"]');return e.length>0&&(w("warn",`[Adapter] Found ${e.length} elements with login href attributes that will be converted to modal`),e.forEach(e=>{!function(e){w("debug","[Adapter] Replacing login href with modal"),e.setAttribute("href","#"),e.setAttribute("data-ms-modal","login"),w("debug","[Adapter] Successfully replaced login href with modal")}(e)})),e.length}function F(e){w("trace","[Adapter] Starting plan attributes update process");w("warn",`[Adapter] Working with ${Object.keys(e).length} imported memberships`);const t=L(e),r=I(e),o=M(e),n=D(),a=function(){w("debug","[Adapter] Handling signup page URLs");const e=document.querySelectorAll('a[href*="#/ms/signup/"]'),t=Array.from(e).filter(e=>{const t=e.getAttribute("href");return t&&!t.startsWith("#/ms/signup/")});return t.length>0&&(w("warn",`[Adapter] Found ${t.length} elements with signup page URLs that will be handled on the destination page`),t.forEach((e,t)=>{const r=e.getAttribute("href");if(r){const e=r.match(/#\/ms\/signup\/(.+)$/);e&&e[1]?w("debug",`[Adapter] Signup page URL ${t+1}: ${r} (ID: ${e[1]})`):w("debug",`[Adapter] Signup page URL ${t+1}: ${r} (no ID extracted)`)}}),w("debug",`[Adapter] Logged ${t.length} signup page URLs for processing on destination page`)),t.length}();w("info",`[Adapter] Plan attributes update completed. Processed ${t+r+o+n} elements total (${a} page URLs logged)`)}function R(e){w("debug",`Replacing logout attribute for element:${e.tagName}`),e.removeAttribute("data-ms-logout"),e.removeAttribute("ms-logout"),e.setAttribute("data-ms-action","logout")}function C(){w("debug","Starting attribute update process");const e=document.querySelectorAll("[data-ms-logout]");e.length>0&&(w("warn",`Found ${e.length} elements with deprecated data-ms-logout attribute`),e.forEach(e=>{R(e)}));const t=document.querySelectorAll("[ms-logout]");t.length>0&&(w("warn",`Found ${t.length} elements with deprecated ms-logout attribute`),t.forEach(e=>{R(e)}));const r=document.querySelectorAll("[ms-forgot]");r.length>0&&(w("warn",`Found ${r.length} elements with deprecated ms-forgot attribute`),r.forEach(e=>{!function(e){w("debug",`Replacing forgot password attribute for element:${e.tagName}`),e.removeAttribute("ms-forgot"),e.setAttribute("data-ms-modal","forgot-password")}(e)}));const o=document.querySelectorAll("[ms-login]");o.length>0&&(w("warn",`Found ${o.length} elements with deprecated ms-login attribute`),o.forEach(e=>{!function(e){w("debug",`Replacing login attribute for element:${e.tagName}`),e.removeAttribute("ms-login"),e.setAttribute("data-ms-modal","login")}(e)}));const n=document.querySelectorAll("[ms-signup]");n.length>0&&(w("warn",`Found ${n.length} elements with deprecated ms-signup attribute`),n.forEach(e=>{!function(e){w("debug",`Replacing signup attribute for element:${e.tagName}`),e.removeAttribute("ms-signup"),e.setAttribute("data-ms-modal","signup")}(e)}));w("debug",`Attribute update completed. Updated ${e.length+t.length+r.length+o.length} elements total`)}function P(e,t,r){if(w("trace",`[Adapter] Replacing member attribute for property: ${t}`),!t.startsWith("membership."))return w("debug",`[Adapter] Skipping non-membership property: ${t}`),!1;if(!r.planConnections||0===r.planConnections.length)return w("error","[Adapter] No plan connections found in member data"),!1;const o=function(e,t){var r;if(w("debug",`[Adapter] Getting nested property "${t}" from plan item`),!e)return w("error","[Adapter] Plan item object is null/undefined"),"";let o="";return"membership.name"===t?(o=e.planId,w("debug",`[Adapter] Mapped membership.name to planId: ${o}`)):"membership.amount"===t?(o=String(null==(r=e.payment)?void 0:r.amount)||"0",w("debug",`[Adapter] Mapped membership.amount to payment.amount: ${o}`)):"membership.status"===t?(o=e.status,w("debug",`[Adapter] Mapped membership.status to status: ${o}`)):w("error",`[Adapter] Unknown property path: ${t}`),o}(r.planConnections[0],t);return o?(e.textContent=o,w("debug",`[Adapter] Set member property "${t}" to "${o}" on ${e.tagName} element`),!0):(w("debug",`[Adapter] Empty value for member property "${t}" - element content not updated`),!1)}function j(e){w("trace","[Adapter] Starting all member updates process");const t=function(){w("debug","[Adapter] Starting rewrite attributes update process");const e=document.querySelectorAll("[data-ms-rewrite]");if(0===e.length)return w("debug","[Adapter] No elements with data-ms-rewrite attribute found"),0;if(w("warn",`[Adapter] Found ${e.length} elements with data-ms-rewrite attribute`),!y())return w("debug","[Adapter] Member not authenticated, skipping rewrite attributes update"),0;let t=0;return e.forEach(e=>{const r=e.getAttribute("data-ms-rewrite");r?(e.textContent=r,t++,w("debug",`[Adapter] Updated element content to: "${r}"`)):w("debug","[Adapter] Element has empty data-ms-rewrite attribute, skipping")}),w("info",`[Adapter] Rewrite attributes update completed. Updated ${t} elements`),t}(),r=(w("debug","[Adapter] No login URL provided, skipping login URL to profile update"),0),o=function(){if(w("trace","[Adapter] Starting member attributes update process"),!y())return w("debug","[Adapter] Member not authenticated with v2, skipping member attributes update"),0;const e=v();if(!e)return w("error","[Adapter] Failed to fetch member data"),0;w("debug",`[Adapter] Retrieved member data for member ID: ${e.id}`);let t=0;const r=document.querySelectorAll("[data-ms-member^='membership.']");return r.length&&(w("warn",`[Adapter] Found ${r.length} elements with membership-related data-ms-member attributes`),r.forEach(r=>{const o=r.getAttribute("data-ms-member");o&&P(r,o,e)&&t++})),w("info",`[Adapter] Member attributes update completed. Processed ${t} elements`),t}();w("debug",`[Adapter] All member updates completed. Updated ${t+r+o} elements total`)}async function U(){document.addEventListener("DOMContentLoaded",()=>{F(r.adapter.importedMemberships),C(),function(){var e;w("debug","[Adapter] Checking for signup forms on page load");const t=document.querySelectorAll('[data-ms-form="signup"]');if(0===t.length)return void w("debug","[Adapter] No signup forms found on this page");w("warn",`[Adapter] Found ${t.length} signup form(s) on page`);const o=window.location.hash,n=o.match(/#\/ms\/signup\/(.+)$/);if(!n||!n[1])return void w("debug",`[Adapter] No plan ID found in URL hash: ${o}`);const a=n[1];w("debug",`[Adapter] Extracted plan ID from URL: ${a}`);const s=null==(e=r.adapter.importedMemberships)?void 0:e[a];if(!s)return void w("error",`[Adapter] Extracted Plan ID from URL "${a}" not found in config.importedMemberships`);const i=k(s);i?(t.forEach((e,t)=>{e.setAttribute(i,s),w("debug",`[Adapter] Added ${i}="${s}" to signup form ${t+1}`)}),w("info",`[Adapter] Successfully updated ${t.length} signup form(s) with plan ID ${s}`)):w("error",`[Adapter] Invalid new plan ID format "${s}"`)}()}),w("trace","[Adapter] starting legacy adapter...");try{window.$memberstackDom||await O("https://static.memberstack.com/scripts/v1/memberstack.js",r);const e=window.$memberstackDom;if(!e)throw"[Adapter] Failed to load Memberstack 2.0";window.MemberStack=S(e),j(),w("trace","[Adapter] 2.0 adapter enabled and injected.")}catch(e){e instanceof Error&&e.message?w("error",`${e.message}`,e):w("error",`[Adapter] Unknown error: ${e}`)}}function O(e,t){return window.memberstackConfig=window.memberstackConfig||t,new Promise((r,o)=>{var n;const a=document.createElement("script");if(a.src=e,a.onload=()=>r(null),a.onerror=()=>{document.head.removeChild(a),o(new Error(`Failed to load ${e}`))},"v1"===(null==(n=t.adapter)?void 0:n.currentVersion)){document.head.appendChild(a).setAttribute("data-memberstack-id",t.appIdV1)}else document.head.appendChild(a)})}!async function(){r.adapter.enabled?"v2"===function(t){var r;const o=new URLSearchParams(window.location.search),n=o.get(A),a=sessionStorage.getItem(e);let s;return n?(s="true"===n||"v2"===n?"v2":"v1",sessionStorage.setItem(e,s),w("trace",`[Adapter] Adapter version ${s} set via query params. Updating session storage and cleaning up query params.`),o.delete(A),window.history.replaceState({},"",`${window.location.pathname}${o.toString()?"?"+o.toString():""}`)):!a||"v1"!==a&&"v2"!==a?(null==(r=t.adapter)?void 0:r.forcedVersion)?(s=t.adapter.forcedVersion,w("trace",`[Adapter] Using forced version: ${t.adapter.forcedVersion}`)):s="v1":s=a,t.adapter.currentVersion=s,s}(r)?(w("start","[Adapter] V2 Adapter enabled."),document.cookie="__ms=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="__stripe_mid=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="__stripe_sid=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",localStorage.removeItem("memberstack"),w("info","[Adapter] V1 Session deleted"),function(){if(!window.MemberStack){let e;const t=new Promise(t=>{e=t});window.MemberStack={onReady:t,__resolveOnReady:e}}}(),await U()):(w("start","[Adapter] Adapter not enabled â€” using v1."),await O("https://api.memberstack.io/static/memberstack.js?webflow",r)):w("start","[Adapter] Adapter disabled.")}()}();
